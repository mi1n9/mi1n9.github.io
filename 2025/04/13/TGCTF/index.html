<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.19.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="qwq 比赛过一半了才开始打，不过还好都做出来了(看来最近还是有进步的XD 前面的都是些板子题，wp就写最后两题了(好吧其实就是比较懒…">
<meta property="og:type" content="article">
<meta property="og:title" content="TGCTF">
<meta property="og:url" content="http://example.com/2025/04/13/TGCTF/index.html">
<meta property="og:site_name" content="浮白载笔">
<meta property="og:description" content="qwq 比赛过一半了才开始打，不过还好都做出来了(看来最近还是有进步的XD 前面的都是些板子题，wp就写最后两题了(好吧其实就是比较懒…">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ooo.0x0.ooo/2025/04/13/O0u7Pq.png">
<meta property="article:published_time" content="2025-04-13T09:39:45.000Z">
<meta property="article:modified_time" content="2025-04-16T12:45:52.372Z">
<meta property="article:author" content="mi1n9">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ooo.0x0.ooo/2025/04/13/O0u7Pq.png">


<link rel="canonical" href="http://example.com/2025/04/13/TGCTF/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2025/04/13/TGCTF/","path":"2025/04/13/TGCTF/","title":"TGCTF"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>TGCTF | 浮白载笔</title>
  

  <script src="/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?841f86b735a025664beab6e082daa3d3"></script>







  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">浮白载笔</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">苍山负雪，明烛天南</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>links</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#EZREA"><span class="nav-number">1.</span> <span class="nav-text">EZREA</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE"><span class="nav-number">1.1.</span> <span class="nav-text">题目</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#LLLCG"><span class="nav-number">2.</span> <span class="nav-text">LLLCG</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE-1"><span class="nav-number">2.1.</span> <span class="nav-text">题目</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="mi1n9"
      src="https://q.qlogo.cn/headimg_dl?dst_uin=2605742754&spec=640&img_type=jpg">
  <p class="site-author-name" itemprop="name">mi1n9</p>
  <div class="site-description" itemprop="description">夜将寒色去，年共晓光新</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">34</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1403921843&auto=1&height=66"></iframe>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/04/13/TGCTF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://q.qlogo.cn/headimg_dl?dst_uin=2605742754&spec=640&img_type=jpg">
      <meta itemprop="name" content="mi1n9">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="浮白载笔">
      <meta itemprop="description" content="夜将寒色去，年共晓光新">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="TGCTF | 浮白载笔">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          TGCTF
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-04-13 17:39:45" itemprop="dateCreated datePublished" datetime="2025-04-13T17:39:45+08:00">2025-04-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-04-16 20:45:52" itemprop="dateModified" datetime="2025-04-16T20:45:52+08:00">2025-04-16</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>18k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>32 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>qwq</p>
<p>比赛过一半了才开始打，不过还好都做出来了(看来最近还是有进步的XD</p>
<p>前面的都是些板子题，wp就写最后两题了(好吧其实就是比较懒…</p>
<span id="more"></span>

<h1 id="EZREA"><a href="#EZREA" class="headerlink" title="EZREA"></a>EZREA</h1><h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag, get_random_emojiiiiii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genarate_emojiiiiii_prime</span>(<span class="params">nbits, base=<span class="number">0</span></span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(base // <span class="number">32</span> * <span class="number">32</span>) <span class="keyword">if</span> base &gt;= <span class="number">3</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nbits // <span class="number">8</span> // <span class="number">4</span> - base // <span class="number">32</span>):</span><br><span class="line">            p = (p &lt;&lt; <span class="number">32</span>) + get_random_emojiiiiii() <span class="comment"># 猜一猜</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">return</span> p</span><br><span class="line">m = bytes_to_long(flag.encode()+ <span class="string">&quot;&quot;</span>.join([long_to_bytes(get_random_emojiiiiii()).decode() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]).encode())</span><br><span class="line">p = genarate_emojiiiiii_prime(<span class="number">512</span>, <span class="number">224</span>)</span><br><span class="line">q = genarate_emojiiiiii_prime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="string">&quot;💯&quot;</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, bytes_to_long(e.encode()), n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p0 =&quot;</span>, long_to_bytes(p % <span class="number">2</span> ** <span class="number">256</span>).decode())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="comment"># p0 = 😘😾😂😋😶😾😳😷</span></span><br><span class="line"><span class="comment"># n = 156583691355552921614631145152732482393176197132995684056861057354110068341462353935267384379058316405283253737394317838367413343764593681931500132616527754658531492837010737718142600521325345568856010357221012237243808583944390972551218281979735678709596942275013178851539514928075449007568871314257800372579</span></span><br><span class="line"><span class="comment"># c = 47047259652272336203165844654641527951135794808396961300275905227499051240355966018762052339199047708940870407974724853429554168419302817757183570945811400049095628907115694231183403596602759249583523605700220530849961163557032168735648835975899744556626132330921576826526953069435718888223260480397802737401</span></span><br></pre></td></tr></table></figure>

<p>将给出的p0转化为实际的p低位，此时泄露的低位是256bit，而p为512位，所以此时已知的位数是不足以支撑我们直接打copper的，分析源码不难看到，p后面应该是有9个emoji的，而我们已知的只有8个，对这八个emoji分析一下，发现它们前六位16进制是一样的，那么已知前六位后面的位数爆一下就行。这样就又知道32位，copper就很好打了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line">p0_emojis = <span class="string">&quot;😘😾😂😋😶😾😳😷&quot;</span></span><br><span class="line">n =<span class="number">156583691355552921614631145152732482393176197132995684056861057354110068341462353935267384379058316405283253737394317838367413343764593681931500132616527754658531492837010737718142600521325345568856010357221012237243808583944390972551218281979735678709596942275013178851539514928075449007568871314257800372579</span></span><br><span class="line">c =<span class="number">47047259652272336203165844654641527951135794808396961300275905227499051240355966018762052339199047708940870407974724853429554168419302817757183570945811400049095628907115694231183403596602759249583523605700220530849961163557032168735648835975899744556626132330921576826526953069435718888223260480397802737401</span></span><br><span class="line">e_str = <span class="string">&quot;💯&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将e转换为整数</span></span><br><span class="line">e_bytes = e_str.encode()</span><br><span class="line">e = bytes_to_long(e_bytes)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="comment">#e=4036989615</span></span><br><span class="line"><span class="comment"># 将p0的emojis转换为整数b</span></span><br><span class="line">plow = bytes_to_long(p0_emojis.encode())</span><br><span class="line"><span class="built_in">print</span>(plow)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_p</span>():</span><br><span class="line">    P.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">256</span>):</span><br><span class="line">        f = x * <span class="number">2</span>**(<span class="number">256</span>+<span class="number">32</span>) + (<span class="number">0xf09f9800</span>+i)*<span class="number">2</span>**<span class="number">256</span> + plow</span><br><span class="line">        f = f.monic()  <span class="comment"># 转换为monic多项式</span></span><br><span class="line">        roots = f.small_roots(X=<span class="number">2</span>^<span class="number">224</span>, beta=<span class="number">0.4</span>)</span><br><span class="line">        <span class="keyword">if</span> roots:</span><br><span class="line">            x0 = roots[<span class="number">0</span>]</span><br><span class="line">            p = <span class="built_in">int</span>(x0)* <span class="number">2</span>**(<span class="number">256</span>+<span class="number">32</span>) +(<span class="number">0xf09f9800</span>+i)*<span class="number">2</span>**<span class="number">256</span> + plow</span><br><span class="line">            <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">                q = n // p</span><br><span class="line">                <span class="keyword">return</span> p, q</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">p, q = solve_p()</span><br></pre></td></tr></table></figure>

<p>解出pq之后发现还存在e与phi不互素的问题，有限域开根即可，又因为flag尾部有填充使其大于n，所以最后解出的m要爆一下加上k倍n。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"><span class="comment"># 已知的值</span></span><br><span class="line">p0_emojis = <span class="string">&quot;😘😾😂😋😶😾😳😷&quot;</span></span><br><span class="line">n =<span class="number">156583691355552921614631145152732482393176197132995684056861057354110068341462353935267384379058316405283253737394317838367413343764593681931500132616527754658531492837010737718142600521325345568856010357221012237243808583944390972551218281979735678709596942275013178851539514928075449007568871314257800372579</span></span><br><span class="line">c =<span class="number">47047259652272336203165844654641527951135794808396961300275905227499051240355966018762052339199047708940870407974724853429554168419302817757183570945811400049095628907115694231183403596602759249583523605700220530849961163557032168735648835975899744556626132330921576826526953069435718888223260480397802737401</span></span><br><span class="line">e_str = <span class="string">&quot;💯&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将e转换为整数</span></span><br><span class="line">e_bytes = e_str.encode()</span><br><span class="line">e = bytes_to_long(e_bytes)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="comment">#e=4036989615</span></span><br><span class="line"><span class="comment"># 将p0的emojis转换为整数b</span></span><br><span class="line">plow = bytes_to_long(p0_emojis.encode())</span><br><span class="line"><span class="built_in">print</span>(plow)</span><br><span class="line"><span class="comment"># 使用SageMath的Coppersmith方法求解p的高位</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_p</span>():</span><br><span class="line">    <span class="comment"># 注意：以下代码应在SageMath环境中运行</span></span><br><span class="line">    P.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">256</span>):</span><br><span class="line">        f = x * <span class="number">2</span>**(<span class="number">256</span>+<span class="number">32</span>) + (<span class="number">0xf09f9800</span>+i)*<span class="number">2</span>**<span class="number">256</span> + plow</span><br><span class="line">        f = f.monic()  <span class="comment"># 转换为monic多项式</span></span><br><span class="line">        <span class="comment"># 寻找小根</span></span><br><span class="line">        roots = f.small_roots(X=<span class="number">2</span>^<span class="number">224</span>, beta=<span class="number">0.4</span>)</span><br><span class="line">        <span class="keyword">if</span> roots:</span><br><span class="line">            x0 = roots[<span class="number">0</span>]</span><br><span class="line">            p = <span class="built_in">int</span>(x0)* <span class="number">2</span>**(<span class="number">256</span>+<span class="number">32</span>) +(<span class="number">0xf09f9800</span>+i)*<span class="number">2</span>**<span class="number">256</span> + plow</span><br><span class="line">            <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">                q = n // p</span><br><span class="line">                <span class="keyword">return</span> p, q</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">p, q = solve_p()</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">g = gcd(e, phi)</span><br><span class="line">d = gmpy2.invert(e//g, phi)</span><br><span class="line">c = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">PR.&lt;x&gt; = Zmod(q)[]</span><br><span class="line">f = x^g - c</span><br><span class="line">resq = f.roots()</span><br><span class="line">PR.&lt;x&gt; = Zmod(p)[]</span><br><span class="line">f = x^g - c</span><br><span class="line">resp = f.roots()</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> resp:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> resq:</span><br><span class="line">            ti = <span class="built_in">int</span>(i[<span class="number">0</span>])</span><br><span class="line">            tj = <span class="built_in">int</span>(j[<span class="number">0</span>])</span><br><span class="line">            nn = [p,q]</span><br><span class="line">            c = [ti,tj]</span><br><span class="line">            m = long_to_bytes(<span class="built_in">int</span>(crt(c,nn))+k*n)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">b&quot;TGCTF&#123;&quot;</span> <span class="keyword">in</span> m:</span><br><span class="line">                <span class="built_in">print</span>(m.decode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">                </span><br><span class="line">                </span><br><span class="line">TGCTF&#123;🙇🏮🤟_🫡🫡🫡_🚩🚩🚩&#125;😃😖😘😨😢</span><br></pre></td></tr></table></figure>



<h1 id="LLLCG"><a href="#LLLCG" class="headerlink" title="LLLCG"></a>LLLCG</h1><h2 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, inverse, bytes_to_long, isPrime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, dsa_p, dsa_q</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TripleLCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed1, seed2, seed3, a, b, c, d, n</span>):</span><br><span class="line">        self.state = [seed1, seed2, seed3]</span><br><span class="line">        self.a = a</span><br><span class="line">        self.b = b</span><br><span class="line">        self.c = c</span><br><span class="line">        self.d = d</span><br><span class="line">        self.n = n</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        new = (self.a * self.state[-<span class="number">3</span>] + self.b * self.state[-<span class="number">2</span>] + self.c * self.state[-<span class="number">1</span>] + self.d) % self.n</span><br><span class="line">        self.state.append(new)</span><br><span class="line">        <span class="keyword">return</span> new</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DSA</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># while True:</span></span><br><span class="line">            <span class="comment"># self.q = getPrime(160)</span></span><br><span class="line">            <span class="comment"># t = 2 * getPrime(1024 - 160) * self.q</span></span><br><span class="line">            <span class="comment"># if isPrime(t + 1):</span></span><br><span class="line">            <span class="comment">#    self.p = t + 1</span></span><br><span class="line">            <span class="comment">#    break</span></span><br><span class="line">        self.p = dsa_p</span><br><span class="line">        self.q = dsa_q</span><br><span class="line">        self.g = <span class="built_in">pow</span>(<span class="number">2</span>, (self.p - <span class="number">1</span>) // self.q, self.p)</span><br><span class="line">        self.x = randint(<span class="number">1</span>, self.q - <span class="number">1</span>)</span><br><span class="line">        self.y = <span class="built_in">pow</span>(self.g, self.x, self.p)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">self, msg, k</span>):</span><br><span class="line">        h = bytes_to_long(sha256(msg).digest())</span><br><span class="line">        r = <span class="built_in">pow</span>(self.g, k, self.p) % self.q</span><br><span class="line">        s = (inverse(k, self.q) * (h + self.x * r)) % self.q</span><br><span class="line">        <span class="keyword">return</span> (r, s)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self, msg, r, s</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">0</span> &lt; r &lt; self.q <span class="keyword">and</span> <span class="number">0</span> &lt; s &lt; self.q):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        h = bytes_to_long(sha256(msg).digest())</span><br><span class="line">        w = inverse(s, self.q)</span><br><span class="line">        u1 = (h * w) % self.q</span><br><span class="line">        u2 = (r * w) % self.q</span><br><span class="line">        v = ((<span class="built_in">pow</span>(self.g, u1, self.p) * <span class="built_in">pow</span>(self.y, u2, self.p)) % self.p) % self.q</span><br><span class="line">        <span class="keyword">return</span> v == r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_recvall</span>(<span class="params">self</span>):</span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="keyword">if</span> newline:</span><br><span class="line">            msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">        self.request.sendall(msg)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;[-] &#x27;</span></span>):</span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        n = getPrime(<span class="number">128</span>)</span><br><span class="line">        a, b, c, d = [randint(<span class="number">1</span>, n - <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        seed1, seed2, seed3 = [randint(<span class="number">1</span>, n - <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line">        lcg = TripleLCG(seed1, seed2, seed3, a, b, c, d, n)</span><br><span class="line">        dsa = DSA()</span><br><span class="line"></span><br><span class="line">        self.send(<span class="string">b&quot;Welcome to TGCTF Challenge!\n&quot;</span>)</span><br><span class="line">        self.send(<span class="string">f&quot;p = <span class="subst">&#123;dsa.p&#125;</span>, q = <span class="subst">&#123;dsa.q&#125;</span>, g = <span class="subst">&#123;dsa.g&#125;</span>, y = <span class="subst">&#123;dsa.y&#125;</span>&quot;</span>.encode())</span><br><span class="line"></span><br><span class="line">        small_primes = [<span class="number">59093</span>, <span class="number">65371</span>, <span class="number">37337</span>, <span class="number">43759</span>, <span class="number">52859</span>, <span class="number">39541</span>, <span class="number">60457</span>, <span class="number">61469</span>, <span class="number">43711</span>]</span><br><span class="line">        used_messages = <span class="built_in">set</span>()</span><br><span class="line">        <span class="keyword">for</span> o_v <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            self.send(<span class="string">b&quot;Select challenge parts: 1, 2, 3\n&quot;</span>)</span><br><span class="line">            parts = self.recv().decode().split()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;1&#x27;</span> <span class="keyword">in</span> parts:</span><br><span class="line">                self.send(<span class="string">b&quot;Part 1\n&quot;</span>)</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">                    self.send(<span class="string">f&quot;Message <span class="subst">&#123;i + <span class="number">1</span>&#125;</span>: &quot;</span>.encode())</span><br><span class="line">                    msg = self.recv()</span><br><span class="line">                    used_messages.add(msg)</span><br><span class="line">                    k = lcg.<span class="built_in">next</span>()</span><br><span class="line">                    r, s = dsa.sign(msg, k)</span><br><span class="line">                    self.send(<span class="string">f&quot;r = <span class="subst">&#123;r&#125;</span>, ks = <span class="subst">&#123;[k % p <span class="keyword">for</span> p <span class="keyword">in</span> small_primes]&#125;</span>\n&quot;</span>.encode())</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;2&#x27;</span> <span class="keyword">in</span> parts:</span><br><span class="line">                self.send(<span class="string">b&quot;Part 2\n&quot;</span>)</span><br><span class="line">                <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">307</span>):</span><br><span class="line">                    k = lcg.<span class="built_in">next</span>()</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">                    self.send(<span class="string">f&quot;Message <span class="subst">&#123;i + <span class="number">1</span>&#125;</span>: &quot;</span>.encode())</span><br><span class="line">                    msg = self.recv()</span><br><span class="line">                    k = lcg.<span class="built_in">next</span>() % dsa.q</span><br><span class="line">                    r, s = dsa.sign(msg, k)</span><br><span class="line">                    self.send(<span class="string">f&quot;Signature: r = <span class="subst">&#123;r&#125;</span>, s = <span class="subst">&#123;s&#125;</span>\n&quot;</span>.encode())</span><br><span class="line">                    used_messages.add(msg)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;3&#x27;</span> <span class="keyword">in</span> parts:</span><br><span class="line">                self.send(<span class="string">b&quot;Part 3\n&quot;</span>)</span><br><span class="line">                self.send(<span class="string">b&quot;Forged message: &quot;</span>)</span><br><span class="line">                final_msg = self.recv()</span><br><span class="line">                self.send(<span class="string">b&quot;Forged r: &quot;</span>)</span><br><span class="line">                r = <span class="built_in">int</span>(self.recv())</span><br><span class="line">                self.send(<span class="string">b&quot;Forged s: &quot;</span>)</span><br><span class="line">                s = <span class="built_in">int</span>(self.recv())</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> final_msg <span class="keyword">in</span> used_messages:</span><br><span class="line">                    self.send(<span class="string">b&quot;Message already signed!\n&quot;</span>)</span><br><span class="line">                <span class="keyword">elif</span> dsa.verify(final_msg, r, s):</span><br><span class="line">                    self.send(<span class="string">f&quot;Good! Your flag: <span class="subst">&#123;flag&#125;</span>\n&quot;</span>.encode())</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.send(<span class="string">b&quot;Invalid signature.\n&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>流程其实挺明显的，第一步先crt还原12个原始的k。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">ks_list = [</span><br><span class="line">    [<span class="number">18144</span>, <span class="number">33550</span>, <span class="number">15828</span>, <span class="number">30959</span>, <span class="number">48055</span>, <span class="number">21409</span>, <span class="number">55277</span>, <span class="number">60983</span>, <span class="number">27974</span>],</span><br><span class="line">    [<span class="number">33254</span>, <span class="number">18141</span>, <span class="number">19884</span>, <span class="number">38282</span>, <span class="number">19608</span>, <span class="number">30103</span>, <span class="number">36078</span>, <span class="number">48578</span>, <span class="number">19691</span>],</span><br><span class="line">    [<span class="number">43478</span>, <span class="number">36510</span>, <span class="number">21394</span>, <span class="number">18099</span>, <span class="number">42696</span>, <span class="number">27427</span>, <span class="number">10055</span>, <span class="number">30795</span>, <span class="number">14918</span>],</span><br><span class="line">    [<span class="number">30090</span>, <span class="number">51294</span>, <span class="number">29908</span>, <span class="number">28851</span>, <span class="number">33992</span>, <span class="number">4252</span>, <span class="number">41985</span>, <span class="number">17401</span>, <span class="number">26266</span>],</span><br><span class="line">    [<span class="number">23152</span>, <span class="number">5186</span>, <span class="number">29545</span>, <span class="number">15719</span>, <span class="number">50738</span>, <span class="number">8159</span>, <span class="number">28032</span>, <span class="number">27997</span>, <span class="number">21099</span>],</span><br><span class="line">    [<span class="number">9121</span>, <span class="number">22105</span>, <span class="number">26722</span>, <span class="number">11305</span>, <span class="number">26292</span>, <span class="number">37115</span>, <span class="number">12080</span>, <span class="number">38193</span>, <span class="number">42520</span>],</span><br><span class="line">    [<span class="number">51784</span>, <span class="number">33933</span>, <span class="number">17590</span>, <span class="number">2964</span>, <span class="number">11630</span>, <span class="number">35938</span>, <span class="number">60263</span>, <span class="number">52100</span>, <span class="number">7168</span>],</span><br><span class="line">    [<span class="number">46287</span>, <span class="number">37239</span>, <span class="number">8837</span>, <span class="number">29461</span>, <span class="number">29558</span>, <span class="number">19703</span>, <span class="number">58889</span>, <span class="number">9987</span>, <span class="number">8019</span>],</span><br><span class="line">    [<span class="number">27085</span>, <span class="number">43021</span>, <span class="number">34083</span>, <span class="number">7970</span>, <span class="number">49456</span>, <span class="number">28955</span>, <span class="number">7654</span>, <span class="number">15399</span>, <span class="number">26179</span>],</span><br><span class="line">    [<span class="number">56587</span>, <span class="number">19720</span>, <span class="number">17702</span>, <span class="number">19136</span>, <span class="number">18096</span>, <span class="number">30237</span>, <span class="number">35725</span>, <span class="number">41940</span>, <span class="number">5641</span>],</span><br><span class="line">    [<span class="number">34551</span>, <span class="number">7739</span>, <span class="number">9530</span>, <span class="number">13547</span>, <span class="number">14430</span>, <span class="number">1966</span>, <span class="number">18834</span>, <span class="number">60855</span>, <span class="number">4516</span>],</span><br><span class="line">    [<span class="number">36530</span>, <span class="number">33550</span>, <span class="number">5789</span>, <span class="number">6862</span>, <span class="number">21181</span>, <span class="number">9761</span>, <span class="number">15665</span>, <span class="number">44059</span>, <span class="number">30590</span>],</span><br><span class="line">]</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover_k</span>(<span class="params">ks, small_primes</span>):</span><br><span class="line">    <span class="comment"># 检查模数数量是否匹配</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ks) != <span class="built_in">len</span>(small_primes):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;模数数量不匹配：<span class="subst">&#123;<span class="built_in">len</span>(ks)&#125;</span> vs <span class="subst">&#123;<span class="built_in">len</span>(small_primes)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 应用CRT</span></span><br><span class="line">    k, modulus = crt(small_primes, ks)</span><br><span class="line">    <span class="keyword">if</span> modulus <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;CRT无解&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> k</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例用法</span></span><br><span class="line">small_primes = [<span class="number">59093</span>, <span class="number">65371</span>, <span class="number">37337</span>, <span class="number">43759</span>, <span class="number">52859</span>, <span class="number">39541</span>, <span class="number">60457</span>, <span class="number">61469</span>, <span class="number">43711</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k_values = []</span><br><span class="line"><span class="keyword">for</span> ks <span class="keyword">in</span> ks_list:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        k = recover_k(ks, small_primes)</span><br><span class="line">        k_values.append(k)</span><br><span class="line">    <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;恢复k失败：<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(k_values)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validate_k_values</span>(<span class="params">k_values, a, b, c, d, n</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="built_in">len</span>(k_values)):</span><br><span class="line">        expected = (a * k_values[i-<span class="number">3</span>] + b * k_values[i-<span class="number">2</span>] + c * k_values[i-<span class="number">1</span>] + d) % n</span><br><span class="line">        <span class="keyword">if</span> k_values[i] != expected:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"> <span class="comment">#[157101007535598128199763730609215207385, 66274988845381039949079863771715267644, 166481247772714670426226746005260813542, 161260164226704447658736707470547064647, 36435681607381391113708443463015014458, 82281529169898991351916873693756667320, 198840548058726242384817514760176867304, 156097296767146131123217198085491596070, 177394558729600631444719167500317039356, 113844659993616865112462511677854300122, 90876110302057884623256087861753326428, 123151927203163513388753930448251250941]</span></span><br></pre></td></tr></table></figure>

<p>然后gröbner-基直接解abcdn(关于gröbner-基的知识回头专门写一下。挖坑ing……)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from Cryptodome.Util.number import getPrime, isPrime</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TripleLCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed1, seed2, seed3, a, b, c, d, n</span>):</span><br><span class="line">        self.state = [seed1, seed2, seed3]</span><br><span class="line">        self.a = a</span><br><span class="line">        self.b = b</span><br><span class="line">        self.c = c</span><br><span class="line">        self.d = d</span><br><span class="line">        self.n = n</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        new = (self.a * self.state[-<span class="number">3</span>] + self.b * self.state[-<span class="number">2</span>] + self.c * self.state[-<span class="number">1</span>] + self.d) % self.n</span><br><span class="line">        self.state.append(new)</span><br><span class="line">        <span class="keyword">return</span> new</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next1</span>(<span class="params">self</span>):</span><br><span class="line">        new = (self.a * self.state[-<span class="number">3</span>] + self.b * self.state[-<span class="number">2</span>] + self.c * self.state[-<span class="number">1</span>] + self.d)</span><br><span class="line">        self.state.append(new)</span><br><span class="line">        <span class="keyword">return</span> new</span><br><span class="line"></span><br><span class="line"><span class="comment"># print((seed1, seed2, seed3))</span></span><br><span class="line"></span><br><span class="line">l_list=[<span class="number">157101007535598128199763730609215207385</span>, <span class="number">66274988845381039949079863771715267644</span>, <span class="number">166481247772714670426226746005260813542</span>, <span class="number">161260164226704447658736707470547064647</span>, <span class="number">36435681607381391113708443463015014458</span>, <span class="number">82281529169898991351916873693756667320</span>, <span class="number">198840548058726242384817514760176867304</span>, <span class="number">156097296767146131123217198085491596070</span>, <span class="number">177394558729600631444719167500317039356</span>, <span class="number">113844659993616865112462511677854300122</span>, <span class="number">90876110302057884623256087861753326428</span>, <span class="number">123151927203163513388753930448251250941</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#PR.&lt;a,b,c,d&gt; = PolynomialRing(Zmod(n))</span></span><br><span class="line">R=PolynomialRing(ZZ,names=[<span class="string">&#x27;seed1&#x27;</span>,<span class="string">&#x27;seed2&#x27;</span>,<span class="string">&#x27;seed3&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">seed1,seed2,seed3,a,b,c,d=R.gens()</span><br><span class="line">l=TripleLCG(seed1,seed2,seed3,a,b,c,d,n)</span><br><span class="line">fs=[l.next1()-l_list[_] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>)]</span><br><span class="line">res = Ideal(fs).groebner_basis()</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#[seed1 + 27553442761320803111033927459351301439, seed2 + 8751726402848649210592158816653868133, seed3 + 151675940788388913235685454123990751505, a + 190977597196110730368051435445041597812, b + 92142738520715948485383509663407014763, c + 27559439992420203108859060145440838759, d + 127040748918708020271648934423063832295, 201571730232643984713598504087145846411]</span></span><br></pre></td></tr></table></figure>

<p>注意一点是多项式的那个lcg不能模n，所以咱新定义一个不模n的next1()。</p>
<p>得到结果为</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[seed1 + <span class="number">27553442761320803111033927459351301439</span>, seed2 + <span class="number">8751726402848649210592158816653868133</span>, seed3 + <span class="number">151675940788388913235685454123990751505</span>, a + <span class="number">190977597196110730368051435445041597812</span>, b + <span class="number">92142738520715948485383509663407014763</span>, c + <span class="number">27559439992420203108859060145440838759</span>, d + <span class="number">127040748918708020271648934423063832295</span>, <span class="number">201571730232643984713598504087145846411</span>]</span><br></pre></td></tr></table></figure>

<p>因为此时是ZZ下的，我们需要模n才能得到对应的参数，此时n已知是列表最后一个值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from Cryptodome.Util.number import getPrime, isPrime</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TripleLCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed1, seed2, seed3, a, b, c, d, n</span>):</span><br><span class="line">        self.state = [seed1, seed2, seed3]</span><br><span class="line">        self.a = a</span><br><span class="line">        self.b = b</span><br><span class="line">        self.c = c</span><br><span class="line">        self.d = d</span><br><span class="line">        self.n = n</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        new = (self.a * self.state[-<span class="number">3</span>] + self.b * self.state[-<span class="number">2</span>] + self.c * self.state[-<span class="number">1</span>] + self.d) % self.n</span><br><span class="line">        self.state.append(new)</span><br><span class="line">        <span class="keyword">return</span> new</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next1</span>(<span class="params">self</span>):</span><br><span class="line">        new = (self.a * self.state[-<span class="number">3</span>] + self.b * self.state[-<span class="number">2</span>] + self.c * self.state[-<span class="number">1</span>] + self.d)</span><br><span class="line">        self.state.append(new)</span><br><span class="line">        <span class="keyword">return</span> new</span><br><span class="line"></span><br><span class="line"><span class="comment"># print((seed1, seed2, seed3))</span></span><br><span class="line"></span><br><span class="line">l_list=[<span class="number">157101007535598128199763730609215207385</span>, <span class="number">66274988845381039949079863771715267644</span>, <span class="number">166481247772714670426226746005260813542</span>, <span class="number">161260164226704447658736707470547064647</span>, <span class="number">36435681607381391113708443463015014458</span>, <span class="number">82281529169898991351916873693756667320</span>, <span class="number">198840548058726242384817514760176867304</span>, <span class="number">156097296767146131123217198085491596070</span>, <span class="number">177394558729600631444719167500317039356</span>, <span class="number">113844659993616865112462511677854300122</span>, <span class="number">90876110302057884623256087861753326428</span>, <span class="number">123151927203163513388753930448251250941</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#PR.&lt;a,b,c,d&gt; = PolynomialRing(Zmod(n))</span></span><br><span class="line">R=PolynomialRing(ZZ,names=[<span class="string">&#x27;seed1&#x27;</span>,<span class="string">&#x27;seed2&#x27;</span>,<span class="string">&#x27;seed3&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">seed1,seed2,seed3,a,b,c,d=R.gens()</span><br><span class="line">l=TripleLCG(seed1,seed2,seed3,a,b,c,d,n)</span><br><span class="line">fs=[l.next1()-l_list[_] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>)]</span><br><span class="line">res = Ideal(fs).groebner_basis()</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line">n=res[-<span class="number">1</span>]</span><br><span class="line">a1 = (<span class="built_in">int</span>(-res[-<span class="number">5</span>].coefficients()[-<span class="number">1</span>]))%n</span><br><span class="line">b1 = (<span class="built_in">int</span>(-res[-<span class="number">4</span>].coefficients()[-<span class="number">1</span>]))%n</span><br><span class="line">c1 = (<span class="built_in">int</span>(-res[-<span class="number">3</span>].coefficients()[-<span class="number">1</span>]))%n</span><br><span class="line">d1 = (<span class="built_in">int</span>(-res[-<span class="number">2</span>].coefficients()[-<span class="number">1</span>]))%n</span><br><span class="line"><span class="built_in">print</span>(a1, b1, c1, d1,n)</span><br></pre></td></tr></table></figure>

<p>得到abcdn之后我们令seed1，seed2，seed3分别为12个L_list中的最后三个，这样就可以直接进行选项二的相关计算。</p>
<p>接下来进行选项二，总结一下就是使用签名的第一个k是又经过307次后的lcg，给了10个r与s，不难想到是基于DSA的HNP问题。但是经过尝试发现一般的做法无法规约出满足x数量级的结果。因为此时</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.x = randint(<span class="number">1</span>, self.q - <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>而q.bit_length()为160，k为128bit，如果用常规的格，我们用hermite定理算一下目标向量的上界</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Cryptodome.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line">q = <span class="number">2</span> ** <span class="number">160</span>  <span class="comment">#这是不断调整配平用的</span></span><br><span class="line"></span><br><span class="line">k = getPrime(<span class="number">128</span>)</span><br><span class="line">n = <span class="number">10</span></span><br><span class="line">det = b**<span class="number">8</span> * p</span><br><span class="line">d = <span class="number">10</span>  <span class="comment"># 固定维度为10</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#行列式的值 大于等于下面的即可</span></span><br><span class="line">temp = gmpy2.iroot(n, <span class="number">2</span>)[<span class="number">0</span>] * gmpy2.iroot(det, n)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(temp.bit_length())</span><br><span class="line"><span class="comment">#143</span></span><br></pre></td></tr></table></figure>

<p>规约的结果大概在140bit左右，无法满足x的数量级，于是我们消去x之后再构造格。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line">p = <span class="number">184352699172192576270535944394450689601424152593934253476634864667530549943623545663040121406222033469867822007490624607150449533351028007649079671823930639894259153639431593427418637301705583834256344087212849054820629604266938603002612952530534395948672534275310804229044744624757608906107492972246321630467</span></span><br><span class="line">q = <span class="number">1427475768627039429244287846531087092897981204933</span></span><br><span class="line">g = <span class="number">179483243075904419855912998377411172058265425529332248345132802466991524049692135618377118498301129461020930474539980424661227889497234584809425572665861532126589551010542468047939006056449514768312598585142121764108071687257917794156000007175743318015987068492602701013540262918705248846831651675444456948643</span></span><br><span class="line">pub = <span class="number">54884188997326601359599787036043506119635369973227482283575973303351693468286083685287116449863315576780372925810244957407166691261517117554272822798968878772154198076753886325003194197379281859876166969023933981704669393734463626888269951684215603375668858306179349767736536431082505780313254891563573390253</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">R = [<span class="number">148590806153419827724339726990091397905591402606</span>,<span class="number">468587768889425188554914584107352890374371541595</span>,<span class="number">901770213009129837614467382135571180822353132590</span>, <span class="number">1330151145631513076455454105987436105211713528764</span>,<span class="number">331667580376318482999087774580790380825533290453</span> ,<span class="number">682290803507883337976555643141471988447481161883</span>,<span class="number">634727119970951647301759741572839717481802229033</span>,<span class="number">1172616314967477654997316628716630727130426052661</span>,<span class="number">1089664533556588559445540694688565197117173310003</span>,<span class="number">890700218361721914728950340639736213065049362259</span>]</span><br><span class="line">S = [<span class="number">660073161938587295481357566429001480170192573464</span>,<span class="number">611592232206260574497361142810354157715543361968</span>,<span class="number">86793524106744688031778546317784224352746650116</span>,<span class="number">1218644002365966553601808129998576715718081163905</span> ,<span class="number">433500422665337372505774675888170887530349544997</span> ,<span class="number">10344246519169918837524783594476396498245810962</span>,<span class="number">450287919965503030465861776359747490559973956386</span>,<span class="number">374667818105670172745467693889735333632563514138</span>,<span class="number">328883113800069887058407240772946894520387812077</span>,<span class="number">1408039250037229328943363054244322294582875644812</span>]</span><br><span class="line">H=[<span class="number">48542053925442562206970678378617219313498267117402160926478466274825158240536</span>, <span class="number">28883776514293686205974736560481993689319284820030920089116394094945705779832</span>, <span class="number">60227679323494732845079296800676036207500808522664099213572118347332946861665</span>, <span class="number">104106124079444489401234144366816756749130613637798248135653762626327064447963</span>, <span class="number">80283700410109442895443923996515124100017195164941306832535727414324507872473</span>, <span class="number">31272006352818487860575454286046758918581076444685961675641400200272101685731</span>, <span class="number">35636157012003773287358551729976022692587201728035380794864775897295160791370</span>, <span class="number">66943969713086776032173464195394550745560523545004192271047021628614662158183</span>, <span class="number">111173944174536807762032075597619344951712520004199781046240639195575158906923</span>, <span class="number">50339944187942351215260199271802340824538591744877537036933672380566647403587</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_k</span>():</span><br><span class="line">    n = <span class="built_in">len</span>(R)</span><br><span class="line">    r0 = R[<span class="number">0</span>]</span><br><span class="line">    h0 = H[<span class="number">0</span>]</span><br><span class="line">    s0 = S[<span class="number">0</span>]</span><br><span class="line">    A = []</span><br><span class="line">    B = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        a = inverse((r0 * S[i]), q) * (R[i] * s0) % q</span><br><span class="line">        b = inverse((r0 * S[i]), q) * (H[i] * r0 - h0 * R[i])</span><br><span class="line">        A.append(a)</span><br><span class="line">        B.append(b)</span><br><span class="line"></span><br><span class="line">    Ge = Matrix(ZZ, n + <span class="number">2</span>, n + <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        Ge[i, i] = q</span><br><span class="line">        Ge[-<span class="number">2</span>, i] = A[i]</span><br><span class="line">        Ge[-<span class="number">1</span>, i] = B[i]</span><br><span class="line">    K = <span class="number">2</span> ** <span class="number">128</span></span><br><span class="line">    Ge[-<span class="number">2</span>, -<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    Ge[-<span class="number">1</span>, -<span class="number">1</span>] = K</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(line[-<span class="number">1</span>]) == K:</span><br><span class="line">            <span class="keyword">return</span> line[-<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k0 = get_k()</span><br><span class="line"><span class="built_in">print</span>(k0)</span><br><span class="line">s0 = S[<span class="number">0</span>]</span><br><span class="line">r0 = R[<span class="number">0</span>]</span><br><span class="line">h0 = H[<span class="number">0</span>]</span><br><span class="line">x=<span class="built_in">int</span>((s0 * k0 - h0) * gmpy2.invert(r0,q) % q)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure>

<p>得到x之后在选项3使用选项2的最后一次k签名msg提交即可</p>
<p><img src="https://ooo.0x0.ooo/2025/04/13/O0u7Pq.png" alt="O0u7Pq.png"></p>
<p>脚本交互一直报错只能手动交互了XD</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/wp/" rel="tag"># wp</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/04/11/MT19937/" rel="prev" title="MT19937">
                  <i class="fa fa-angle-left"></i> MT19937
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/04/20/Grobner%E5%9F%BA%E5%AD%A6%E4%B9%A0/" rel="next" title="Gröbner基学习">
                  Gröbner基学习 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">mi1n9</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">698k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">21:10</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
